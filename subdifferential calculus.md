---
date: 1718156992.443497
tags:
- autogenerated
- source__oai
- conversation_id__18aef735-d044-4209-927f-ec249ab3595f
- msg_aaa241f3-3c57-4b64-954b-d701fb479346
- msg_ae4faf83-51b3-4c40-b42d-02457d0be611
- colorclass/system-dynamics
title: subdifferential calculus
---

**USER**

Subdifferential Calculus


**ASSISTANT**

### Subdifferential Calculus

Subdifferential calculus extends the concept of differentiation to nonsmooth functions, providing tools to analyze and optimize functions that are not necessarily differentiable. This calculus is fundamental in optimization, control theory, and variational analysis, where nonsmooth functions frequently arise.

### Subdifferentials

#### Convex Subdifferential

For a convex function \( f: \mathbb{R}^n \to \mathbb{R} \), the subdifferential at a point \( x \) is defined as:
$$
\partial f(x) = \{ g \in \mathbb{R}^n \mid f(y) \geq f(x) + g^T (y - x) \text{ for all } y \in \mathbb{R}^n \}
$$
The elements of \( \partial f(x) \) are called subgradients. If \( f \) is differentiable at \( x \), then \( \partial f(x) = \{\nabla f(x)\} \).

#### Clarke Subdifferential

For a locally Lipschitz function \( f: \mathbb{R}^n \to \mathbb{R} \), the Clarke subdifferential at \( x \) is given by:
$$
\partial_C f(x) = \text{conv} \left\{ \lim_{i \to \infty} \nabla f(x_i) \mid x_i \to x, x_i \notin S_f \right\}
$$
where \( S_f \) is the set of points where \( f \) is not differentiable, and \( \text{conv} \) denotes the convex hull.

### Properties of Subdifferentials

1. **Non-emptiness**:
   - For a convex function, the subdifferential \( \partial f(x) \) is non-empty at any point in the interior of its domain.

2. **Closedness**:
   - The subdifferential \( \partial f(x) \) is a closed set.

3. **Monotonicity**:
   - For convex functions, the subdifferential mapping is monotone, meaning if \( g \in \partial f(x) \) and \( h \in \partial f(y) \), then:
     $$
     (g - h)^T (x - y) \geq 0
     $$

### Calculus Rules for Subdifferentials

#### Sum Rule

For convex functions \( f \) and \( g \):
$$
\partial (f + g)(x) \subseteq \partial f(x) + \partial g(x)
$$
If \( f \) and \( g \) are both convex, the equality holds:
$$
\partial (f + g)(x) = \partial f(x) + \partial g(x)
$$

#### Chain Rule

For a convex function \( f: \mathbb{R} \to \mathbb{R} \) and a differentiable function \( \phi: \mathbb{R}^n \to \mathbb{R} \) with gradient \( \nabla \phi \):
$$
\partial (f \circ \phi)(x) = \nabla \phi(x) \partial f(\phi(x))
$$

#### Product Rule

For functions \( f \) and \( g \):
$$
\partial (f \cdot g)(x) \subseteq f(x) \partial g(x) + g(x) \partial f(x)
$$

#### Maximum Rule

For a finite collection of convex functions \( \{f_i\}_{i=1}^m \):
$$
\partial \left( \max_{i} f_i \right)(x) = \text{conv} \left( \bigcup_{i \in I(x)} \partial f_i(x) \right)
$$
where \( I(x) = \{i \mid f_i(x) = \max_j f_j(x)\} \).

### Applications

#### Optimization

Subdifferential calculus is instrumental in developing optimization algorithms for nonsmooth problems. Subgradient methods, for instance, extend the gradient descent method to nonsmooth functions by using subgradients instead of gradients.

#### Variational Analysis

Subdifferentials are crucial in variational analysis, which studies the stability and perturbation of optimization problems and variational inequalities.

#### Control Theory

In control theory, subdifferential calculus aids in analyzing and solving differential inclusions, which generalize differential equations to include nonsmooth dynamics.

### Example: Subdifferential of the Absolute Value Function

Consider the function \( f(x) = |x| \).

- For \( x > 0 \), \( f(x) = x \), so \( \partial f(x) = \{1\} \).
- For \( x < 0 \), \( f(x) = -x \), so \( \partial f(x) = \{-1\} \).
- At \( x = 0 \), \( \partial f(0) = [-1, 1] \).

The subdifferential at any point \( x \) is:
$$
\partial |x| = 
\begin{cases} 
\{1\} & \text{if } x > 0 \\
\{-1\} & \text{if } x < 0 \\
[-1, 1] & \text{if } x = 0 
\end{cases}
$$

### Conclusion

Subdifferential calculus provides a powerful framework for extending the tools of classical calculus to nonsmooth functions. Its rules and properties enable the analysis and optimization of functions that are not differentiable, making it indispensable in fields like optimization, control theory, and variational analysis. For further reading, explore [[Convex Analysis]], [[Optimization Theory]], and [[Differential Inclusions]].


---

preceding: [[nonsmooth analysis]]  


following: [[differential inclusions]]

See also: [[control theory]]


See also: [[convex hull]]


See also: [[smooth dynamics]]