---
date: 1726438356.141811
tags:
- autogenerated
- source__oai
- conversation_id__66e757d1-0534-8008-bb6a-afa8342b5ee2
- msg_aaa23c91-1c12-4b00-b614-3b793e592cc4
- msg_8c4bd407-10fa-4b5f-b271-159ded809b86
- colorclass/edge-case
title: introduce the `list` type in the context of sending multiple prompts
---

**USER**

introduce the `list` type in the context of sending multiple prompts


**ASSISTANT**

Introducing the `list` type in the context of sending **multiple prompts** to the GPT API can be a powerful and practical way for students to understand how lists work, as well as how to process multiple requests efficiently. This approach allows them to experiment with Python’s list handling, iteration, and see how lists can be combined with their earlier learning of API interactions and CLI tools.

Here’s how we can weave the concept of `list` into an assignment that builds on previous work while focusing on multiple prompt submissions.

### **Fourth Assignment: Working with Lists to Send Multiple Prompts**

### **Objective**:
- Teach students how to use Python’s `list` type to store and manipulate multiple prompts.
- Show how to iterate over a list to send multiple prompts in a single API call or in sequence.
- Reinforce string manipulation and prompt engineering by allowing students to work with different types of prompts.

### **Concepts**:
1. **Lists**: Storing multiple prompts.
2. **Iteration**: Looping over lists to make multiple API requests.
3. **Aggregating Results**: Collecting responses for multiple prompts.

### **Python List Basics**:

Before jumping into the API interaction, introduce the basic syntax for creating and manipulating lists:
```python
# A simple list of prompts
prompts = ["Tell me a joke.", "What's the weather like?", "Give me a fun fact."]
```

You can show them simple list operations like:
- **Accessing elements**:
  ```python
  print(prompts[0])  # Output: Tell me a joke.
  ```
- **Appending elements**:
  ```python
  prompts.append("Explain quantum mechanics in simple terms.")
  ```

### **Updated Script for Sending Multiple Prompts**:

In this assignment, students will extend their existing script to accept multiple prompts either directly as a list in the code or via a file, and then send these prompts one by one to the GPT model.

```python
import os
import openai
import fire

# Step 1: Fetch API key from environment variables
api_key = os.environ.get("OPENAI_API_KEY")
if not api_key:
    raise ValueError("API key not found. Set the OPENAI_API_KEY environment variable.")

# Step 2: Define a function to query GPT with a prompt and sampling parameters
def query_gpt(prompt, max_tokens=50, temperature=0.7, top_p=1.0):
    openai.api_key = api_key
    response = openai.Completion.create(
        model="text-davinci-003",
        prompt=prompt,
        max_tokens=max_tokens,
        temperature=temperature,  # Adjusts randomness
        top_p=top_p              # Adjusts diversity
    )
    return response.choices[0].text.strip()

# Step 3: Function to handle a list of prompts
def query_multiple_prompts(prompts, max_tokens=50, temperature=0.7, top_p=1.0):
    results = []
    for prompt in prompts:
        response = query_gpt(prompt, max_tokens, temperature, top_p)
        results.append(response)
        print(f"\nPrompt: {prompt}")
        print(f"AI Response: {response}")
    return results

# Step 4: Add CLI using Fire
def main(prompts=None, prompt_file=None, max_tokens=50, temperature=0.7, top_p=1.0):
    """
    CLI for sending multiple prompts to OpenAI GPT-3.
    
    - `prompts`: A list of prompts to send (comma-separated values).
    - `prompt_file`: A file containing prompts (one per line).
    - Other sampling parameters: `temperature`, `top_p`, `max_tokens`.
    """
    if prompts:
        prompts_list = prompts.split(',')
    elif prompt_file:
        with open(prompt_file, 'r') as f:
            prompts_list = [line.strip() for line in f.readlines()]
    else:
        prompts_list = ["Hello, world!"]  # Default single prompt

    query_multiple_prompts(prompts_list, max_tokens, temperature, top_p)

if __name__ == "__main__":
    fire.Fire(main)
```

### **Assignment Tasks**:

1. **Run the Script with Multiple Prompts**:
   Students can pass a list of prompts from the command line by separating them with commas:
   ```bash
   python hello_gpt_multiple.py --prompts "Tell me a joke.,What's the weather like?,Give me a fun fact."
   ```

   Output:
   ```bash
   Prompt: Tell me a joke.
   AI Response: Why don’t skeletons fight each other? They don’t have the guts.

   Prompt: What's the weather like?
   AI Response: I'm sorry, I can't check real-time weather, but it's always good to carry an umbrella!

   Prompt: Give me a fun fact.
   AI Response: Honey never spoils! Archaeologists have found pots of honey in ancient Egyptian tombs that are over 3,000 years old and still perfectly edible.
   ```

2. **Run the Script with Prompts from a File**:
   Students can also provide a file that contains one prompt per line. The script will read the file and send each prompt sequentially.

   Create a file `prompts.txt`:
   ```
   Tell me a joke.
   What's the weather like?
   Give me a fun fact.
   ```

   Then run the script:
   ```bash
   python hello_gpt_multiple.py --prompt_file prompts.txt
   ```

3. **Iterate Over a List of Prompts**:
   Inside the `query_multiple_prompts()` function, students will learn how to iterate over a list and send each prompt individually to the GPT API. The results will be appended to a list, showing how Python lists can be used to gather results from multiple operations.

### **Additional Learning Concepts**:

1. **List Creation and Manipulation**:
   - Students will see how to create lists directly from input (`prompts.split(',')`) and from files (using `.readlines()`).
   - They will learn how to append results to a list dynamically (`results.append(response)`).

2. **Basic Iteration**:
   - The `for` loop provides a simple introduction to iterating over a list of prompts, helping students understand the basics of list processing and iteration in Python.

3. **Combining Lists and Strings**:
   - By manipulating lists of strings (prompts), students will understand how string operations and list manipulations work together in real-world applications.

### **Assignment Extension (Optional)**:

Students could be asked to modify the script so that the prompts and their corresponding responses are saved to a file, reinforcing file I/O operations.

```python
def save_responses_to_file(responses, filename="responses.txt"):
    with open(filename, 'w') as f:
        for i, response in enumerate(responses):
            f.write(f"Prompt {i+1}: {response}\n")
```

They can then add this function to the `main()` and allow saving:
```bash
python hello_gpt_multiple.py --prompts "Tell me a joke.,What's the weather like?" --max_tokens 30 --save_output "output.txt"
```

### **Learning Outcomes**:
- **Lists**:
  - Students will understand how to use Python lists to handle multiple pieces of data (prompts).
  - They will learn how to loop through lists using `for` loops to send multiple API requests.
  
- **Iteration and Aggregation**:
  - How to iterate over lists and collect results dynamically into new lists.
  
- **File I/O (Optional)**:
  - Optionally, students will learn how to read and write lists of prompts from/to files, building a more practical understanding of working with data in Python.

---

### **Summary**:

This assignment introduces the `list` type in a practical and engaging way by focusing on sending multiple prompts to the GPT API. It reinforces previous lessons about API interaction while building students' knowledge of list operations and iteration in Python.


---

preceding: [[third assignment experimenting with sampling parameters]]  


following: [[this is over complicated, we don't need to introduce `for` here. the `openai` library supports sending multiple prompts in a single request. keep it simple, the strategy here is to be completely pragm]]