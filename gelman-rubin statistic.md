---
date: 1721161740.578118
tags:
- autogenerated
- source__oai
- conversation_id__4f78839e-971a-4476-b886-e0eef3bd4caf
- msg_cc5d95a6-361c-441e-99cf-e572f1a5b8b8
- msg_cfe4da42-908b-4992-a29d-073d66342fb7
- colorclass/game-theory
title: gelman-rubin statistic
---

**USER**

Gelman-Rubin statistic


**ASSISTANT**

The Gelman-Rubin statistic, also known as the potential scale reduction factor (PSRF), is a diagnostic tool used in Markov Chain Monte Carlo (MCMC) simulations to assess the convergence of multiple chains to the target posterior distribution. The statistic compares the variance within each chain to the variance between chains, providing a measure of how well the chains have mixed and whether they have converged to the same distribution.

## Definition and Calculation

### Multiple Chains

Suppose we run $m$ parallel chains, each of length $n$, initialized from different starting points. Let $\theta_{ij}$ denote the $i$-th sample from the $j$-th chain, where $i = 1, 2, \ldots, n$ and $j = 1, 2, \ldots, m$. The goal is to determine if these $m$ chains have converged to the same posterior distribution.

### Steps to Compute the Gelman-Rubin Statistic

1. **Compute the Within-Chain Variance**:
   
   For each chain $j$, compute the sample variance:
   $$
   s_j^2 = \frac{1}{n-1} \sum_{i=1}^n (\theta_{ij} - \bar{\theta}_j)^2
   $$
   where $\bar{\theta}_j = \frac{1}{n} \sum_{i=1}^n \theta_{ij}$ is the mean of the $j$-th chain.

   The within-chain variance is the average of these variances:
   $$
   W = \frac{1}{m} \sum_{j=1}^m s_j^2
   $$

2. **Compute the Between-Chain Variance**:
   
   Compute the mean of all chain means:
   $$
   \bar{\theta} = \frac{1}{m} \sum_{j=1}^m \bar{\theta}_j
   $$

   The between-chain variance is:
   $$
   B = \frac{n}{m-1} \sum_{j=1}^m (\bar{\theta}_j - \bar{\theta})^2
   $$

3. **Estimate the Marginal Posterior Variance**:
   
   The marginal posterior variance $\hat{V}$ is a weighted average of the within-chain and between-chain variances:
   $$
   \hat{V} = \frac{n-1}{n} W + \frac{1}{n} B
   $$

4. **Compute the Potential Scale Reduction Factor (PSRF)**:
   
   The Gelman-Rubin statistic $\hat{R}$ is defined as:
   $$
   \hat{R} = \sqrt{\frac{\hat{V}}{W}}
   $$

   When the chains have converged, $\hat{R}$ should be close to 1. A value of $\hat{R} \leq 1.1$ is often considered acceptable, indicating convergence.

## Interpretation

- **$\hat{R} \approx 1$**: Indicates that the chains have likely converged to the target distribution. The variance within the chains is similar to the variance between the chains.
- **$\hat{R} > 1.1$**: Suggests that the chains have not yet converged, and more iterations may be needed. The higher the value, the greater the discrepancy between the within-chain and between-chain variances.

## Example Calculation

Suppose we have 3 chains (m=3) of length 1000 (n=1000) each, and we are interested in assessing the convergence for a parameter $\theta$.

1. Compute the mean and variance for each chain:
   - Chain 1: $\bar{\theta}_1 = 5.2$, $s_1^2 = 0.8$
   - Chain 2: $\bar{\theta}_2 = 5.3$, $s_2^2 = 0.7$
   - Chain 3: $\bar{\theta}_3 = 5.1$, $s_3^2 = 0.9$

2. Compute the overall mean:
   $$
   \bar{\theta} = \frac{1}{3}(5.2 + 5.3 + 5.1) = 5.2
   $$

3. Compute the within-chain variance:
   $$
   W = \frac{1}{3}(0.8 + 0.7 + 0.9) = 0.8
   $$

4. Compute the between-chain variance:
   $$
   B = \frac{1000}{2} \left[ \left(\frac{5.2 - 5.2}{3}\right)^2 + \left(\frac{5.3 - 5.2}{3}\right)^2 + \left(\frac{5.1 - 5.2}{3}\right)^2 \right] = \frac{1000}{2} \left[0 + 0.01 + 0.01\right] = 10
   $$

5. Estimate the marginal posterior variance:
   $$
   \hat{V} = \frac{999}{1000} \cdot 0.8 + \frac{1}{1000} \cdot 10 = 0.807 + 0.01 = 0.817
   $$

6. Compute the potential scale reduction factor:
   $$
   \hat{R} = \sqrt{\frac{0.817}{0.8}} \approx \sqrt{1.02125} \approx 1.01
   $$

Since $\hat{R} \approx 1.01$, this indicates that the chains have likely converged.

## Conclusion

The Gelman-Rubin statistic is a widely used diagnostic tool in MCMC to assess convergence. By comparing the variance within chains to the variance between chains, it provides a quantitative measure to ensure that the chains have mixed well and are sampling from the same target distribution. A value close to 1 indicates convergence, while values significantly greater than 1 suggest that more iterations are needed. This diagnostic is crucial for ensuring the reliability of Bayesian inference results obtained from MCMC simulations.


---

preceding: [[relate [[gibbs sampling]] to coordinate descent]]  


following: [[variational inference]]

See also: [[coordinate descent]]