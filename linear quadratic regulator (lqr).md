---
date: 1722286118.069238
tags:
- autogenerated
- source__oai
- conversation_id__6f4c4860-51ff-462a-a6f4-6ea2aac30386
- msg_aaa20370-13f3-4113-ad4c-c5378d904a29
- msg_333ee663-e580-4f76-87fa-7f05cabbddb4
- colorclass/system-dynamics
title: linear quadratic regulator (lqr)
---

**USER**

Linear Quadratic Regulator


**ASSISTANT**

### Linear Quadratic Regulator (LQR)

The Linear Quadratic Regulator (LQR) is a method in control theory used to design controllers that regulate the behavior of a dynamic system to achieve optimal performance. The LQR technique is particularly effective for linear systems and aims to minimize a quadratic cost function, balancing performance and control effort.

#### System Representation

LQR is applied to linear time-invariant (LTI) systems represented in state-space form:
$$
\dot{\vec{x}}(t) = A\vec{x}(t) + B\vec{u}(t)
$$
$$
\vec{y}(t) = C\vec{x}(t) + D\vec{u}(t)
$$
where:
- \( \vec{x}(t) \) is the state vector.
- \( \vec{u}(t) \) is the control input vector.
- \( \vec{y}(t) \) is the output vector.
- \( A \) is the state matrix.
- \( B \) is the input matrix.
- \( C \) is the output matrix.
- \( D \) is the feedthrough (or direct transmission) matrix.

#### Objective and Cost Function

The objective of LQR is to determine the control input \( \vec{u}(t) \) that minimizes the following quadratic cost function:
$$
J = \int_0^\infty (\vec{x}^T Q \vec{x} + \vec{u}^T R \vec{u}) \, dt
$$
where:
- \( J \) is the cost function to be minimized.
- \( Q \) is a positive semi-definite matrix that weights the state vector.
- \( R \) is a positive definite matrix that weights the control input vector.

The matrices \( Q \) and \( R \) determine the relative importance of minimizing state deviations and control effort, respectively.

#### LQR Controller Design

1. **Algebraic Riccati Equation**:
   - The optimal control input is determined by solving the Algebraic Riccati Equation (ARE):
     $$
     A^T P + P A - P B R^{-1} B^T P + Q = 0
     $$
     where \( P \) is the unique positive definite solution to the ARE.

2. **State Feedback Law**:
   - Once \( P \) is determined, the optimal state feedback control law is given by:
     $$
     \vec{u}(t) = -K \vec{x}(t)
     $$
     where the feedback gain matrix \( K \) is:
     $$
     K = R^{-1} B^T P
     $$

3. **Closed-Loop System**:
   - The closed-loop system dynamics are described by:
     $$
     \dot{\vec{x}}(t) = (A - BK)\vec{x}(t)
     $$
   - The matrix \( A - BK \) governs the stability and response of the closed-loop system.

#### Properties and Advantages

1. **Optimality**:
   - The LQR controller provides the optimal control input that minimizes the cost function, balancing state regulation and control effort.

2. **Stability**:
   - If the pair \( (A, B) \) is controllable and \( Q \) and \( R \) are appropriately chosen, the closed-loop system is guaranteed to be stable.

3. **Robustness**:
   - The LQR design often yields robust controllers that can handle uncertainties and variations in system parameters.

#### Example

Consider a simple mass-spring-damper system represented by:
$$
\ddot{x} + b \dot{x} + k x = u
$$
where \( x \) is the displacement, \( b \) is the damping coefficient, \( k \) is the spring constant, and \( u \) is the control force.

1. **State-Space Representation**:
   Define the state vector \( \vec{x} = \begin{bmatrix} x \\ \dot{x} \end{bmatrix} \). The state-space representation is:
   $$
   \dot{\vec{x}} = \begin{bmatrix} 0 & 1 \\ -k & -b \end{bmatrix} \vec{x} + \begin{bmatrix} 0 \\ 1 \end{bmatrix} u
   $$

2. **Cost Function**:
   Choose:
   $$
   Q = \begin{bmatrix} q_1 & 0 \\ 0 & q_2 \end{bmatrix}, \quad R = r
   $$
   where \( q_1, q_2, \) and \( r \) are positive scalars.

3. **Solving the Riccati Equation**:
   Solve the ARE:
   $$
   A^T P + P A - P B R^{-1} B^T P + Q = 0
   $$
   where:
   $$
   A = \begin{bmatrix} 0 & 1 \\ -k & -b \end{bmatrix}, \quad B = \begin{bmatrix} 0 \\ 1 \end{bmatrix}
   $$

4. **Compute Feedback Gain**:
   Once \( P \) is found, calculate:
   $$
   K = R^{-1} B^T P
   $$

5. **Implement Control Law**:
   Apply the state feedback control:
   $$
   u = -K \vec{x}
   $$

#### Applications

1. **Robotics**:
   - Precise control of robotic arms and mobile robots.

2. **Automotive**:
   - Active suspension systems and cruise control.

3. **Aerospace**:
   - Attitude control of satellites and aircraft.

4. **Industrial Automation**:
   - Process control in manufacturing systems.

#### Further Reading

For more detailed exploration, consider the following related topics:
- [[Optimal Control Theory|Optimal Control Theory]]
- [[State-Space Representation|State-Space Representation]]
- [[Robust Control|Robust Control]]
- [[Dynamic Programming|Dynamic Programming]]

By understanding and applying LQR, engineers and researchers can design controllers that optimally balance performance and control effort, ensuring efficient and stable operation of complex mechanical systems.


---

preceding: [[dynamics and control of mechanical systems]]  


following: [[vibration analysis]]

See also: [[linear quadratic regulator]]


See also: [[control theory]]


See also: [[state-space representation]]


See also: [[state feedback control]]


See also: [[gain matrix]]


See also: [[system dynamics]]