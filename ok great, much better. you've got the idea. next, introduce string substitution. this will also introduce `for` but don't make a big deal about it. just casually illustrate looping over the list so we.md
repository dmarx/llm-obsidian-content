---
date: 1726439578.41014
tags:
- autogenerated
- source__oai
- conversation_id__66e757d1-0534-8008-bb6a-afa8342b5ee2
- msg_aaa202f9-3c7d-480f-b482-0a1acd66a8d5
- msg_bcbb74c9-77cb-4722-afea-c900d41ecaff
- colorclass/edge-case
title: ok great, much better. you've got the idea. next, introduce string substitution.
  this will also introduce `for` but don't make a big deal about it. just casually
  illustrate looping over the list so we
---

**USER**

ok great, much better. you've got the idea. next, introduce string substitution. this will also introduce `for` but don't make a big deal about it. just casually illustrate looping over the list so we can modify its elements. the focus is on str.replace and the general prompt templating strategy of using a placeholder tokens like `<city>`


**ASSISTANT**

Perfect! We’ll introduce **string substitution** and lightly introduce the `for` loop without making it the focus. This will help students understand how to use `str.replace()` to dynamically modify prompts, which is a common technique in prompt engineering. The goal is to teach them how to replace placeholder tokens like `<city>` in a list of prompts, using values they can specify.

Here’s how we can structure this next assignment.

---

### **Fifth Assignment: String Substitution in Prompts**

### **Objective**:
- Introduce students to **string substitution** using `str.replace()`.
- Casually introduce the `for` loop to modify elements in a list.
- Demonstrate how to use a **placeholder** like `<city>` in prompts and dynamically replace it with specific values.

### **Concept**:
Students will start with a list of prompts containing a placeholder token (e.g., `<city>`). They will use `str.replace()` to replace the token with real values, then send the modified prompts to the GPT model.

---

### **Updated Script: String Substitution with Placeholders**

```python
import os
import openai
import fire

# Step 1: Fetch API key from environment variables
api_key = os.environ.get("OPENAI_API_KEY")
if not api_key:
    raise ValueError("API key not found. Set the OPENAI_API_KEY environment variable.")

# Step 2: Define a function that queries GPT with a list of modified prompts
def query_gpt(prompts, max_tokens=50, temperature=0.7, top_p=1.0):
    openai.api_key = api_key
    response = openai.Completion.create(
        model="text-davinci-003",
        prompt=prompts,  # Send the list of modified prompts
        max_tokens=max_tokens,
        temperature=temperature,
        top_p=top_p,
    )
    return response

# Step 3: Add CLI using Fire
def main(city="Paris"):
    """
    Send modified prompts with the <city> placeholder replaced by the specified city.

    Arguments:
    - city: The city name to replace the <city> placeholder.
    """
    # Step 4: Define a list of prompts with a placeholder <city>
    prompts = [
        "What is the population of <city>?",
        "What are some famous landmarks in <city>?",
        "Can you tell me an interesting fact about <city>?"
    ]

    # Step 5: Replace the <city> placeholder in each prompt with the specified city
    modified_prompts = []
    for prompt in prompts:
        modified_prompt = prompt.replace("<city>", city)
        modified_prompts.append(modified_prompt)

    # Step 6: Call the query_gpt function with the modified prompts
    response = query_gpt(modified_prompts)

    # Step 7: Print the raw response object (students will learn how to parse it later)
    print(response)

if __name__ == "__main__":
    fire.Fire(main)
```

---

### **Explanation**:

1. **Step 1**: The usual setup to fetch the API key from the environment.

2. **Step 2**: The `query_gpt()` function remains the same as before. It accepts a list of prompts, sends them to the GPT model, and returns the full response.

3. **Step 3**: The `main()` function introduces a single **parameter** (`city`) to be passed via the command line. This is the value that will replace the `<city>` placeholder in each prompt.

4. **Step 4**: A list of prompts is defined with the placeholder `<city>` in each string:
   ```python
   prompts = [
       "What is the population of <city>?",
       "What are some famous landmarks in <city>?",
       "Can you tell me an interesting fact about <city>?"
   ]
   ```

5. **Step 5**: This step introduces the `for` loop in a casual, low-pressure way:
   - Students replace `<city>` in each prompt using `str.replace()`.
   - The modified prompts are stored in a new list `modified_prompts` for later use.
   ```python
   for prompt in prompts:
       modified_prompt = prompt.replace("<city>", city)
       modified_prompts.append(modified_prompt)
   ```

6. **Step 6**: The modified prompts (with the placeholder replaced) are passed to the `query_gpt()` function and the response is printed.

---

### **Running the Script**:

Students can run the script, specifying a city via the command line. The default value is `"Paris"`, but they can change it to anything else.

**Example Command**:
```bash
python hello_gpt_string_substitution.py --city "New York"
```

**Example Output**:
```bash
<OpenAIObject completion id=cmpl-xxxxxxxxxxxxxxxxx>
```

The full API response object is printed, showing how the model responds to the dynamically modified prompts.

---

### **Learning Outcomes**:

1. **String Substitution**:
   - Students will learn how to use `str.replace()` to replace placeholder tokens (`<city>`) with actual values, which is a critical skill in prompt engineering.
   - They’ll understand how this pattern allows for creating dynamic, reusable prompts.

2. **Casual Introduction to `for` Loops**:
   - While the focus is on string substitution, students will also get a gentle introduction to iterating over lists with `for` loops in Python.
   - The loop is used naturally to modify each element in the list, but the emphasis is on practicality rather than theory.

3. **Multiple Prompt Handling**:
   - This builds on previous lessons by allowing students to modify a list of prompts dynamically, showing the power of list handling combined with string manipulation.

---

### **Assignment Extension (Optional)**:

For an optional challenge, students could replace multiple placeholders in more complex prompts. For example, they could add `<year>` to their prompts and replace both `<city>` and `<year>` with user-provided values.

```python
def main(city="Paris", year="2024"):
    prompts = [
        "What was the population of <city> in <year>?",
        "What were some major events in <city> in <year>?",
        "How has <city> changed since <year>?"
    ]
    
    modified_prompts = []
    for prompt in prompts:
        modified_prompt = prompt.replace("<city>", city).replace("<year>", year)
        modified_prompts.append(modified_prompt)

    response = query_gpt(modified_prompts)
    print(response)
```

They can run:
```bash
python hello_gpt_string_substitution.py --city "London" --year "1999"
```

---

### **Summary**:

In this assignment, students are introduced to **string substitution** in Python using `str.replace()` within a list of prompts, and they get their first exposure to `for` loops in a practical context. By focusing on replacing placeholders in prompts with real values, students will learn a foundational skill in both Python and prompt engineering, while gradually building up their understanding of list manipulation and iteration.


---

preceding: [[what no, way too early for io. we're just introducing them to a list. put multiple prompts in a list, and use our pre-existing machinery from the previous lesson to emit all of the prompts at once, an]]  


following: [[introduce conditional control flow. this includes parenthetical syntax, compound expressions (don't call it that, just show the student that it's a thing they can do). also introduce the `in` operator]]