---
date: '2025-03-08T22:12:16.011055Z'
tags:
- autogenerated
- source__claude
- conversation_id__7f086336-0adc-448a-8aad-49baa9399948
- msg_164ab8d2-6b40-4d61-ac9d-143b25a15a9e
- msg_5dc479d7-0210-44e5-ac13-ce8cfa5ffe2f
- colorclass/systems-theory
title: granger causality
---

**USER**

Granger causality


**ASSISTANT**

# Granger Causality

[[Granger causality]] is a statistical concept for determining whether one time series can be used to forecast another, providing a principled approach to inferring potential causal relationships between variables. Introduced by Nobel laureate [[Clive Granger]] in 1969, this framework has become a cornerstone in the analysis of temporal dependencies in [[complex systems]].

## Formal Definition

Let $X_t$ and $Y_t$ be two [[stationary time series]]. We say that $Y$ [[Granger-causes]] $X$ if the past values of $Y$ contain information that helps predict $X$ beyond the information contained in past values of $X$ alone.

Mathematically, this can be formalized by comparing two predictive models:

1. **Restricted model** (using only $X$'s history):
   $$X_t = \alpha_0 + \sum_{i=1}^{p} \alpha_i X_{t-i} + \varepsilon_t$$

2. **Unrestricted model** (using both $X$ and $Y$ histories):
   $$X_t = \alpha_0 + \sum_{i=1}^{p} \alpha_i X_{t-i} + \sum_{j=1}^{q} \beta_j Y_{t-j} + \varepsilon_t'$$

Where:
- $p$ and $q$ are the lag orders for $X$ and $Y$ respectively
- $\varepsilon_t$ and $\varepsilon_t'$ are residual error terms
- $\alpha_i$ and $\beta_j$ are coefficients

$Y$ Granger-causes $X$ if the unrestricted model produces statistically significant improvement in prediction over the restricted model.

## Statistical Testing

### F-Test Approach

The standard approach utilizes the [[F-test]] to compare the [[residual sum of squares]] (RSS) between models:

$$F = \frac{(RSS_R - RSS_{UR})/q}{RSS_{UR}/(T-p-q-1)}$$

Where:
- $RSS_R$ is the residual sum of squares from the restricted model
- $RSS_{UR}$ is the residual sum of squares from the unrestricted model
- $T$ is the number of observations
- $F$ follows an F-distribution with $(q, T-p-q-1)$ degrees of freedom under the null hypothesis

The null hypothesis ($H_0$: $Y$ does not Granger-cause $X$) is rejected if $F$ exceeds the critical value at a chosen significance level.

### Likelihood Ratio Test

For [[vector autoregression]] (VAR) models, the [[likelihood ratio test]] is often used:

$$LR = T(\ln|\Sigma_R| - \ln|\Sigma_{UR}|)$$

Where $\Sigma_R$ and $\Sigma_{UR}$ are the variance-covariance matrices of the residuals for the restricted and unrestricted models, respectively.

## Extensions and Variations

### Multivariate Granger Causality

For a system of $n$ time series variables $\{X^1, X^2, \ldots, X^n\}$, multivariate Granger causality examines whether a subset of variables Granger-causes another variable while controlling for remaining variables.

The VAR model becomes:

$$X_t^i = \alpha_0^i + \sum_{j=1}^{n} \sum_{k=1}^{p_j} \alpha_{jk}^i X_{t-k}^j + \varepsilon_t^i$$

### Nonlinear Granger Causality

For systems with [[nonlinear dynamics]], the linear formulation can be extended to:

$$X_t = f(X_{t-1}, \ldots, X_{t-p}) + g(Y_{t-1}, \ldots, Y_{t-q}) + \varepsilon_t$$

Where $f$ and $g$ are nonlinear functions, often approximated using:
- [[Kernel methods]]
- [[Neural networks]]
- [[Local polynomial regression]]

### Frequency-Domain Granger Causality

[[Spectral Granger causality]] extends the analysis to the frequency domain, measuring causality at different frequency components:

$$f_{Y\rightarrow X}(\omega) = \ln\left(\frac{S_{XX}(\omega)}{S_{XX}(\omega) - |\Sigma_{12}|^2 S_{YY}^{-1}(\omega)}\right)$$

Where:
- $S_{XX}(\omega)$ and $S_{YY}(\omega)$ are the auto-spectra at frequency $\omega$
- $\Sigma_{12}$ represents the covariance between prediction errors

### Conditional Granger Causality

To account for indirect influences through additional variables $Z$, [[conditional Granger causality]] compares:

1. $$X_t = \alpha_0 + \sum_{i=1}^{p} \alpha_i X_{t-i} + \sum_{k=1}^{r} \gamma_k Z_{t-k} + \varepsilon_t$$

2. $$X_t = \alpha_0 + \sum_{i=1}^{p} \alpha_i X_{t-i} + \sum_{j=1}^{q} \beta_j Y_{t-j} + \sum_{k=1}^{r} \gamma_k Z_{t-k} + \varepsilon_t'$$

## Information-Theoretic Formulation

[[Transfer entropy]] provides an information-theoretic analog to Granger causality:

$$T_{Y \rightarrow X} = \sum p(x_{t+1}, x_t^{(p)}, y_t^{(q)}) \log \frac{p(x_{t+1} | x_t^{(p)}, y_t^{(q)})}{p(x_{t+1} | x_t^{(p)})}$$

Where:
- $x_t^{(p)} = (x_t, x_{t-1}, \ldots, x_{t-p+1})$
- $y_t^{(q)} = (y_t, y_t-1, \ldots, y_{t-q+1})$

For [[Gaussian processes]], this precisely equals Granger causality multiplied by a factor of $\frac{1}{2}\ln(2\pi e)$.

## Mathematical Connections

### Relationship to Physical Causality

Granger causality is related to, but distinct from, [[interventional causality]] in the sense of [[Pearl's causal calculus]]. The relationship can be formalized:

Let $do(Y_t = y)$ represent an intervention setting $Y_t$ to value $y$. Then:

- $Y$ Granger-causes $X$ $\iff$ $P(X_{t+1} | X^t) \neq P(X_{t+1} | X^t, Y^t)$
- $Y$ physically causes $X$ $\iff$ $\exists t: P(X_{t+1} | do(Y_t = y)) \neq P(X_{t+1})$

### Structural Vector Autoregression

[[Structural VAR]] models extend Granger causality by incorporating contemporaneous effects:

$$A_0 X_t = A_1 X_{t-1} + \ldots + A_p X_{t-p} + \varepsilon_t$$

Where $A_0$ captures instantaneous relationships between variables.

## Applications in Complex Systems

### Neuroscience

In [[neural connectivity analysis]], Granger causality helps infer effective connectivity between brain regions from:
- [[Electroencephalography]] (EEG)
- [[Functional magnetic resonance imaging]] (fMRI)
- [[Local field potentials]] (LFP)

### Economics and Finance

Applications include:
- [[Price discovery]] across markets
- [[Volatility spillover]] effects
- [[Monetary policy transmission]]

### Climate Science

Used for analyzing:
- [[Teleconnection patterns]]
- [[Climate forcing]] mechanisms
- [[Ocean-atmosphere coupling]]

## Computational Implementation

A standardized algorithm for Granger causality testing:

1. Test both series for [[stationarity]] using [[augmented Dickey-Fuller]] tests
2. Determine optimal lag order using [[Akaike information criterion]] (AIC) or [[Bayesian information criterion]] (BIC)
3. Fit restricted and unrestricted models
4. Compute test statistic and p-value
5. Apply [[multiple testing correction]] if necessary

## Limitations and Challenges

1. **[[Observational sampling rate]]**: Insufficient sampling may mask causal relationships
2. **[[Hidden confounders]]**: Unobserved variables may create spurious causality
3. **[[Non-stationarity]]**: Changing statistical properties invalidate standard tests
4. **[[Model misspecification]]**: Incorrect functional form can lead to false conclusions
5. **[[Anticipatory relationships]]**: Forward-looking behavior can violate temporal precedence assumptions

## Research Directions

1. Developing [[robust Granger causality]] measures for non-stationary and nonlinear systems
2. Integrating [[causal discovery algorithms]] with Granger causality
3. Extending to [[point processes]] and irregularly sampled data
4. Exploring connections with [[quantum causality]]
5. Applying [[topological data analysis]] to extract causal structures

## References

1. Granger, C. W. J. (1969). Investigating causal relations by econometric models and cross-spectral methods. Econometrica, 37(3), 424-438.
2. Geweke, J. (1982). Measurement of linear dependence and feedback between multiple time series. Journal of the American Statistical Association, 77(378), 304-313.
3. Ding, M., Chen, Y., & Bressler, S. L. (2006). Granger causality: Basic theory and application to neuroscience. Handbook of Time Series Analysis, 437-460.
4. Seth, A. K., Barrett, A. B., & Barnett, L. (2015). Granger causality analysis in neuroscience and neuroimaging. Journal of Neuroscience, 35(8), 3293-3297.
5. Barnett, L., & Seth, A. K. (2014). The MVGC multivariate Granger causality toolbox: A new approach to Granger-causal inference. Journal of Neuroscience Methods, 223, 50-68.


---

preceding: [[operational closure]]  


following: [[transfer entropy]]

See also: [[spectral methods]]


See also: [[field potential]]


See also: [[causality]]