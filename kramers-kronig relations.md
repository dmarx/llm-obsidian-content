---
date: '2025-05-11T17:08:55.008165Z'
tags:
- autogenerated
- source__claude
- conversation_id__1c050a53-3939-42dc-b630-9126ce05d464
- msg_ad171d72-51b5-4259-bafb-d67873c541f9
- msg_9c714bba-d1c8-4f7e-b026-1a5ac327e7d4
- colorclass/vector-space
title: kramers-kronig relations
---

**USER**

Kramers-Kronig Relations


**ASSISTANT**

# Kramers-Kronig Relations

The Kramers-Kronig relations represent a fundamental set of mathematical equations that connect the real and imaginary parts of complex-valued functions that are analytic in the upper half of the complex plane. First derived independently by Hendrik Anthony Kramers and Ralph Kronig in the 1920s, these relations have profound implications across multiple fields of physics and engineering, establishing deep connections between causality, dispersion, and the behavior of physical systems.

## Mathematical Formulation

### Basic Formulation

For a complex function $\chi(\omega) = \chi'(\omega) + i\chi''(\omega)$ that is analytic in the upper half-plane and approaches zero sufficiently rapidly as $|\omega| \to \infty$, the Kramers-Kronig relations state:

$$\chi'(\omega) = \frac{1}{\pi} \mathcal{P} \int_{-\infty}^{\infty} \frac{\chi''(\omega')}{\omega' - \omega} d\omega'$$

$$\chi''(\omega) = -\frac{1}{\pi} \mathcal{P} \int_{-\infty}^{\infty} \frac{\chi'(\omega')}{\omega' - \omega} d\omega'$$

where $\mathcal{P}$ denotes the [[Cauchy principal value]] of the integral.

### Alternative Forms

For functions that satisfy certain reality conditions (such as response functions of physical systems), the relations can be written in terms of positive frequencies only:

$$\chi'(\omega) = \frac{2}{\pi} \mathcal{P} \int_{0}^{\infty} \frac{\omega' \chi''(\omega')}{\omega'^2 - \omega^2} d\omega'$$

$$\chi''(\omega) = -\frac{2\omega}{\pi} \mathcal{P} \int_{0}^{\infty} \frac{\chi'(\omega')}{\omega'^2 - \omega^2} d\omega'$$

### Hilbert Transform Formulation

The Kramers-Kronig relations can be elegantly expressed using the [[Hilbert transform]]:

$$\chi'(\omega) = \mathcal{H}[\chi''(\omega)]$$

$$\chi''(\omega) = -\mathcal{H}[\chi'(\omega)]$$

where $\mathcal{H}[f(\omega)]$ denotes the Hilbert transform of $f(\omega)$.

## Theoretical Foundations

### Connection to Causality

The Kramers-Kronig relations are a direct mathematical consequence of causality in physical systems. For a system to be causal, its response at time $t$ can only depend on inputs at times $t' < t$. This translates to the requirement that the response function $\chi(t)$ must be zero for $t < 0$.

In the frequency domain, this causality condition implies that the complex susceptibility $\chi(\omega)$ must be analytic in the upper half of the complex plane, which in turn leads to the Kramers-Kronig relations through [[Cauchy's integral formula]].

### Complex Analysis Derivation

The derivation uses contour integration in the complex plane. Consider a function $\chi(z)$ that is analytic in the upper half-plane and approaches zero as $|z| \to \infty$. For a point $\omega$ on the real axis, we can write:

$$\chi(\omega) = \frac{1}{2\pi i} \oint_{C} \frac{\chi(z)}{z - \omega} dz$$

where $C$ is a contour consisting of the real axis and a semicircle at infinity in the upper half-plane. Decomposing $\chi(z)$ into real and imaginary parts and applying [[Jordan's lemma]] leads to the Kramers-Kronig relations.

### Sum Rules

By evaluating the Kramers-Kronig relations at specific frequencies and making use of asymptotic behavior, various sum rules can be derived. For example, assuming $\chi(\omega) \to 0$ as $\omega \to \infty$, we get:

$$\int_{0}^{\infty} \chi''(\omega) d\omega = \frac{\pi}{2} \chi'(0)$$

These sum rules provide important constraints on physical response functions.

## Applications in Physical Sciences

### Optical Dispersion

In optics, the complex refractive index $n(\omega) + i\kappa(\omega)$ connects to the Kramers-Kronig relations:

$$n(\omega) - 1 = \frac{2}{\pi} \mathcal{P} \int_{0}^{\infty} \frac{\omega' \kappa(\omega')}{\omega'^2 - \omega^2} d\omega'$$

$$\kappa(\omega) = -\frac{2\omega}{\pi} \mathcal{P} \int_{0}^{\infty} \frac{n(\omega') - 1}{\omega'^2 - \omega^2} d\omega'$$

This establishes a fundamental link between dispersion (variation of refractive index with frequency) and absorption (determined by the extinction coefficient).

### Electrical Impedance

For the impedance $Z(\omega) = R(\omega) + iX(\omega)$ of electrical systems, the Kramers-Kronig relations become:

$$R(\omega) = \frac{2}{\pi} \mathcal{P} \int_{0}^{\infty} \frac{\omega' X(\omega')}{\omega'^2 - \omega^2} d\omega'$$

$$X(\omega) = -\frac{2\omega}{\pi} \mathcal{P} \int_{0}^{\infty} \frac{R(\omega')}{\omega'^2 - \omega^2} d\omega'$$

These relations show that the resistive (dissipative) and reactive (energy-storing) components of impedance are not independent but rather are linked by causality.

### Linear Response Theory

In the context of [[linear response theory]], if $\chi(\omega)$ is the generalized susceptibility relating an applied field to the system's response, the Kramers-Kronig relations connect the [[reactive response]] $\chi'(\omega)$ to the [[dissipative response]] $\chi''(\omega)$.

For example, in dielectric materials:
- $\chi'(\omega)$ determines the polarization in phase with the electric field
- $\chi''(\omega)$ determines [[energy dissipation]] and dielectric loss

### Scattering Theory

In [[quantum scattering theory]], the optical theorem connects the imaginary part of the forward scattering amplitude to the total cross-section, while the Kramers-Kronig relations connect this to the real part of the scattering amplitude, providing a complete characterization of scattering processes.

## Experimental Applications

### Material Characterization

#### Spectroscopic Ellipsometry

In ellipsometry, the measured parameters $\Psi(\omega)$ and $\Delta(\omega)$ are related to the complex reflectance. The Kramers-Kronig relations allow researchers to:
- Validate experimental data for consistency with causality
- Reconstruct unmeasured spectral regions
- Extract material parameters like band gaps and oscillator strengths

#### Dielectric Spectroscopy

Dielectric measurements often cover limited frequency ranges. The Kramers-Kronig relations enable:
- Extension of spectral data beyond measured ranges
- Verification of data consistency
- Identification of additional relaxation processes

### Signal Processing

#### Minimum Phase Systems

For [[minimum phase systems]], the magnitude and phase of the frequency response are related through the Kramers-Kronig relations. This is exploited in:
- Audio equalizer design
- Filter synthesis
- Communication channel equalization

### Microscopy Techniques

#### Electron Energy Loss Spectroscopy (EELS)

The Kramers-Kronig relations connect the energy loss function to the dielectric function, allowing:
- Determination of optical properties from electron microscopy data
- Analysis of plasmon resonances
- Characterization of bandgap properties

## Mathematical Extensions and Generalizations

### Subtracted Kramers-Kronig Relations

For functions that do not decay sufficiently rapidly at high frequencies, modified forms are used:

$$\chi'(\omega) - \chi'(\omega_0) = \frac{2(\omega^2 - \omega_0^2)}{\pi} \mathcal{P} \int_{0}^{\infty} \frac{\chi''(\omega')}{(\omega'^2 - \omega^2)(\omega'^2 - \omega_0^2)} d\omega'$$

This approach allows application to systems with more complex asymptotic behavior.

### Truncated Kramers-Kronig Relations

Since experimental data is always measured over a finite frequency range $[\omega_{min}, \omega_{max}]$, practical implementations use:

$$\chi'(\omega) \approx \chi'_{meas}(\omega) + \frac{2}{\pi} \mathcal{P} \int_{\omega_{min}}^{\omega_{max}} \frac{\omega' \chi''(\omega')}{\omega'^2 - \omega^2} d\omega'$$

with corrections for extrapolation outside the measured range.

### Multiple-Subtractions Method

For even more robust analysis, multiple subtractions can be performed:

$$\chi'(\omega) - \sum_{j=1}^{N} a_j \chi'(\omega_j) = \frac{2}{\pi} \mathcal{P} \int_{0}^{\infty} \chi''(\omega') K_N(\omega, \omega', \{\omega_j\}) d\omega'$$

where $K_N$ is a kernel function dependent on the subtraction frequencies $\{\omega_j\}$ and coefficients $\{a_j\}$.

## Computational Implementation

### Direct Numerical Integration

```python
def kramers_kronig_real_to_imag(omega, chi_real):
    """
    Compute the imaginary part from the real part using Kramers-Kronig relations.
    
    Parameters:
    -----------
    omega : array
        Frequency points
    chi_real : array
        Real part of the complex function
    
    Returns:
    --------
    chi_imag : array
        Computed imaginary part
    """
    chi_imag = np.zeros_like(omega)
    
    for i, w in enumerate(omega):
        # Principal value integral
        integrand = np.zeros_like(omega)
        for j, w_prime in enumerate(omega):
            if j != i:  # Skip singularity
                integrand[j] = chi_real[j] / (w_prime**2 - w**2)
        
        # Trapezoidal integration
        chi_imag[i] = -2 * w / np.pi * np.trapz(integrand, omega)
    
    return chi_imag
```

### Fast Fourier Transform Method

A more efficient approach uses the relationship between the Hilbert transform and the Fourier transform:

```python
def kramers_kronig_fft(omega, chi_real):
    """
    Compute Kramers-Kronig transform using FFT.
    
    Parameters:
    -----------
    omega : array
        Frequency points (must be equally spaced)
    chi_real : array
        Real part of the complex function
    
    Returns:
    --------
    chi_imag : array
        Computed imaginary part
    """
    # Ensure omega is evenly spaced
    if not np.allclose(np.diff(omega), np.diff(omega)[0]):
        raise ValueError("Frequency points must be equally spaced")
    
    N = len(omega)
    
    # Create extended array with odd symmetry
    extended = np.zeros(2*N)
    extended[:N] = chi_real
    extended[N:] = -chi_real[::-1]
    
    # Apply Hilbert transform using FFT
    transform = np.fft.fft(extended)
    transform_hilbert = transform * np.concatenate([
        np.ones(1),
        2j * np.ones(N-1),
        np.ones(1),
        np.zeros(N-1)
    ])
    result = np.fft.ifft(transform_hilbert)
    
    # Extract imaginary part
    chi_imag = -np.imag(result[:N])
    
    return chi_imag
```

### Optimized Algorithms for Experimental Data

For experimental data with noise and limited frequency range:

```python
def kramers_kronig_subtracted(omega, chi_real, omega_ref):
    """
    Compute Kramers-Kronig transform with one subtraction point.
    
    Parameters:
    -----------
    omega : array
        Frequency points
    chi_real : array
        Real part of the complex function
    omega_ref : float
        Reference frequency for subtraction
    
    Returns:
    --------
    chi_imag : array
        Computed imaginary part
    """
    # Find index closest to reference frequency
    ref_idx = np.argmin(np.abs(omega - omega_ref))
    chi_ref = chi_real[ref_idx]
    
    chi_imag = np.zeros_like(omega)
    
    for i, w in enumerate(omega):
        integrand = np.zeros_like(omega)
        for j, w_prime in enumerate(omega):
            if j != i:  # Skip singularity
                integrand[j] = (chi_real[j] - chi_ref) / ((w_prime**2 - w**2) * (w_prime**2 - omega_ref**2))
        
        # Trapezoidal integration with subtraction
        chi_imag[i] = -2 * w * (w**2 - omega_ref**2) / np.pi * np.trapz(integrand, omega)
    
    return chi_imag
```

## Advanced Theoretical Aspects

### Dispersion Relations in Quantum Field Theory

In [[quantum field theory]], dispersion relations derived from the Kramers-Kronig framework connect different scattering amplitudes and enforce unitarity:

$$\text{Re}[A(s)] = \frac{1}{\pi} \mathcal{P} \int_{s_{th}}^{\infty} \frac{\text{Im}[A(s')]}{s' - s} ds'$$

where $A(s)$ is a scattering amplitude and $s$ is the Mandelstam variable.

### Connection to Maximum Entropy Methods

The Kramers-Kronig relations can be viewed as constraints in [[maximum entropy]] methods for spectral analysis. When reconstructing a spectrum from limited data, the principle of causality (enforced by Kramers-Kronig relations) provides essential physical constraints.

### Non-Linear Generalizations

For systems exhibiting nonlinear responses, generalized dispersion relations have been developed:

$$\chi^{(n)}(\omega_1, \omega_2, ..., \omega_n) = \frac{1}{\pi} \mathcal{P} \int_{-\infty}^{\infty} \frac{\chi^{(n)}(\omega'_1, \omega_2, ..., \omega_n)}{\omega'_1 - \omega_1} d\omega'_1$$

where $\chi^{(n)}$ is the nth-order nonlinear susceptibility.

## Symbolic Notation and Mathematical Formalism

We can establish a comprehensive notation for the Kramers-Kronig framework:

- Let $\mathcal{H}[f](\omega)$ denote the Hilbert transform of $f(\omega)$
- Let $\mathcal{A}$ represent the space of complex functions analytic in the upper half-plane
- Let $\mathcal{K}: \mathcal{A} \rightarrow \mathcal{A}$ be the Kramers-Kronig operator

For any $\chi \in \mathcal{A}$ with $\chi(\omega) = \chi'(\omega) + i\chi''(\omega)$, the Kramers-Kronig relations can be written as:

$$\mathcal{K}(\chi') = \chi''$$
$$\mathcal{K}(\chi'') = -\chi'$$

The operator $\mathcal{K}$ has the properties:
- $\mathcal{K}^2 = -I$ (where $I$ is the identity operator)
- $\mathcal{K}$ is linear: $\mathcal{K}(\alpha f + \beta g) = \alpha \mathcal{K}(f) + \beta \mathcal{K}(g)$

## Related Concepts

- [[Dispersion Relations]]: Mathematical expressions relating real and imaginary parts of response functions
- [[Causality]]: Principle that effects cannot precede their causes
- [[Hilbert Transform]]: Integral transform closely related to the Kramers-Kronig relations
- [[Analytic Functions]]: Complex functions that are differentiable in their domain
- [[Linear Response Theory]]: Framework for describing how systems respond to small perturbations
- [[Optical Theorem]]: Relation between forward scattering amplitude and total cross-section
- [[Spectral Functions]]: Frequency-domain representations of time-domain signals
- [[Sum Rules]]: Integral constraints on response functions derived from causality
- [[Fluctuation-Dissipation Theorem]]: Relation between system fluctuations and dissipative properties

## Applications Beyond Traditional Physics

### Financial Time Series Analysis

Causal relationships in financial markets can be analyzed using Kramers-Kronig-like relations:
- Market response functions must satisfy causality
- Price volatility and trend components can be related through dispersion relations
- Predictive models can exploit these mathematical constraints

### Biological Systems

Kramers-Kronig relations have been applied to:
- Mechanical properties of biological tissues
- Neural signal processing and brain connectivity analysis
- Reaction-diffusion systems in morphogenesis

### Earth Sciences

Applications include:
- Seismic wave propagation and dispersion
- Electromagnetic sounding of Earth's layers
- Climate system response functions


---

preceding: [[fluctuation-dissipation theorem]]  


following: [[sum rules]]

See also: [[signal processing]]


See also: [[dispersion relation]]


See also: [[spectral analysis]]