---
date: '2025-04-26T16:21:05.425871Z'
tags:
- autogenerated
- source__claude
- conversation_id__4a253f63-6dab-43e7-ab4b-aa19be46436f
- msg_07cfcfd7-9dd3-4f9d-85bc-6f52e13b041c
- msg_11c8036a-2e7b-42bd-acf6-7dd49ab66029
- colorclass/systems-theory
title: system size expansion
---

**USER**

system size expansion


**ASSISTANT**

# System Size Expansion

## Introduction

The **system size expansion** is a powerful mathematical technique for analyzing [[stochastic processes]] in systems with a large number of interacting components. Developed by Nicolaas van Kampen in the 1960s, it provides a systematic framework for approximating the [[master equation]] of a stochastic process by expanding it in terms of powers of a system size parameter. This approach bridges the gap between discrete stochastic descriptions and continuous deterministic models, revealing how macroscopic behavior emerges from microscopic randomness as system size increases.

The system size expansion is particularly valuable in fields such as [[chemical kinetics]], [[systems biology]], [[statistical physics]], and [[population dynamics]], where it helps quantify how intrinsic noise affects system behavior while maintaining mathematical tractability.

## Mathematical Framework

### The Master Equation

The starting point for the system size expansion is the [[master equation]], which describes the time evolution of the probability distribution $P(\mathbf{n}, t)$ over the possible states $\mathbf{n}$ of the system:

$$\frac{\partial P(\mathbf{n}, t)}{\partial t} = \sum_{\mathbf{r}} [W(\mathbf{n} - \mathbf{r}|\mathbf{n})P(\mathbf{n} - \mathbf{r}, t) - W(\mathbf{n}|\mathbf{n} + \mathbf{r})P(\mathbf{n}, t)]$$

Where:
- $W(\mathbf{n}|\mathbf{n}')$ is the transition rate from state $\mathbf{n}'$ to state $\mathbf{n}$
- $\mathbf{r}$ represents the possible changes in the state variables

For chemical reaction systems, this takes the form of the [[Chemical Master Equation]] (CME):

$$\frac{\partial P(\mathbf{n}, t)}{\partial t} = \sum_{j=1}^{M} [a_j(\mathbf{n} - \mathbf{S}_j)P(\mathbf{n} - \mathbf{S}_j, t) - a_j(\mathbf{n})P(\mathbf{n}, t)]$$

Where:
- $a_j(\mathbf{n})$ is the [[propensity function]] for reaction $j$
- $\mathbf{S}_j$ is the stoichiometric vector for reaction $j$
- $M$ is the total number of reaction channels

### The Ansatz

The key insight of the system size expansion is to reformulate the problem in terms of concentration-like variables that separate deterministic behavior from fluctuations. This is achieved through the van Kampen ansatz:

$$\mathbf{n}(t) = \Omega \boldsymbol{\phi}(t) + \Omega^{1/2} \boldsymbol{\xi}(t)$$

Where:
- $\Omega$ is the system size parameter (often volume or total population)
- $\boldsymbol{\phi}(t)$ represents the deterministic trajectory (macroscopic concentration)
- $\boldsymbol{\xi}(t)$ represents the fluctuations around this trajectory

The probability distribution is then expressed in terms of the new variable $\boldsymbol{\xi}$:

$$P(\mathbf{n}, t) = \Pi(\boldsymbol{\xi}, t)$$

### The Expansion

The master equation is rewritten in terms of $\boldsymbol{\xi}$ by transforming the derivative operators using the chain rule:

$$\frac{\partial}{\partial n_i} = \frac{1}{\Omega^{1/2}}\frac{\partial}{\partial \xi_i}$$

The transition rates are expanded in powers of $\Omega^{-1/2}$:

$$a_j(\mathbf{n}) = a_j(\Omega \boldsymbol{\phi} + \Omega^{1/2} \boldsymbol{\xi}) = \Omega f_j(\boldsymbol{\phi}) + \Omega^{1/2} \sum_i \frac{\partial f_j(\boldsymbol{\phi})}{\partial \phi_i} \xi_i + \mathcal{O}(\Omega^0)$$

Where $f_j(\boldsymbol{\phi}) = \lim_{\Omega \to \infty} \Omega^{-1} a_j(\Omega \boldsymbol{\phi})$ is the macroscopic rate function.

This leads to an expansion of the master equation in powers of $\Omega^{-1/2}$:

$$\frac{\partial \Pi(\boldsymbol{\xi}, t)}{\partial t} = \left[\frac{1}{\Omega^0}L_0 + \frac{1}{\Omega^{1/2}}L_1 + \frac{1}{\Omega}L_2 + \ldots\right]\Pi(\boldsymbol{\xi}, t)$$

Where $L_0$, $L_1$, $L_2$, etc., are differential operators of increasing complexity.

## Hierarchical Approximations

The system size expansion provides a hierarchy of approximations, each capturing dynamics at different scales.

### Macroscopic Limit ($\Omega^0$ Term)

The leading order term ($L_0$) yields the deterministic rate equations:

$$\frac{d\phi_i}{dt} = \sum_j S_{ij}f_j(\boldsymbol{\phi})$$

This corresponds to the classical deterministic description of the system in the limit of infinite system size.

### Linear Noise Approximation ($\Omega^{-1/2}$ Term)

The next-order term ($L_1$) gives the [[Linear Noise Approximation]] (LNA), which describes the dynamics of fluctuations:

$$\frac{\partial \Pi(\boldsymbol{\xi}, t)}{\partial t} = -\sum_{i,j} J_{ij}\frac{\partial}{\partial \xi_i}(\xi_j\Pi) + \frac{1}{2}\sum_{i,j} D_{ij}\frac{\partial^2 \Pi}{\partial \xi_i \partial \xi_j}$$

Where:
- $J_{ij} = \frac{\partial}{\partial \phi_j}\left(\sum_{r} S_{ir}f_r(\boldsymbol{\phi})\right)$ is the Jacobian matrix
- $D_{ij} = \sum_{r} S_{ir}S_{jr}f_r(\boldsymbol{\phi})$ is the diffusion matrix

This is a [[Fokker-Planck equation]] describing Gaussian fluctuations around the deterministic trajectory.

### Higher-Order Corrections ($\Omega^{-1}$ and Beyond)

Including the $\Omega^{-1}$ term ($L_2$) gives the [[Effective Mesoscopic Rate Equation]] (EMRE), which captures corrections to the mean due to nonlinear fluctuation effects:

$$\frac{d\langle \phi_i \rangle}{dt} = \sum_j S_{ij}f_j(\boldsymbol{\phi}) + \frac{1}{2\Omega}\sum_{j,k,l} S_{ij} \frac{\partial^2 f_j(\boldsymbol{\phi})}{\partial \phi_k \partial \phi_l} \langle \xi_k \xi_l \rangle$$

Higher-order terms capture increasingly subtle aspects of the probability distribution, including non-Gaussian features.

## Mathematical Methods for Analysis

### Moment Equations

The system size expansion leads naturally to equations for the moments of the fluctuations. For the LNA, the covariance matrix $C_{ij} = \langle \xi_i \xi_j \rangle$ evolves according to the [[Lyapunov equation]]:

$$\frac{dC}{dt} = JC + CJ^T + D$$

For steady states, this becomes:

$$JC_{\text{ss}} + C_{\text{ss}}J^T + D = 0$$

### Spectral Analysis

The properties of fluctuations can be analyzed through the eigenvalues and eigenvectors of the Jacobian matrix $J$. The eigenvalues determine the stability and timescales of the fluctuations, while the eigenvectors identify the principal directions of fluctuation.

The [[power spectral density]] of fluctuations is given by:

$$S_{ij}(\omega) = \sum_k \sum_l (i\omega I - J)^{-1}_{ik} D_{kl} (i\omega I - J)^{-1*}_{jl}$$

This provides a frequency-domain characterization of the noise.

## Applications

### Chemical Reaction Networks

In biochemical systems, the system size expansion reveals how molecular noise affects reaction dynamics. For a simple reaction scheme like:

$$S \xrightarrow{k_1} E \xrightarrow{k_2} P$$

The LNA provides analytical expressions for the variance and correlations in the concentrations of S, E, and P.

### Gene Expression

For gene expression models, the system size expansion quantifies intrinsic noise in mRNA and protein levels. In the standard model:

$$\emptyset \xrightarrow{k_m} \text{mRNA} \xrightarrow{d_m} \emptyset$$
$$\text{mRNA} \xrightarrow{k_p} \text{mRNA} + \text{Protein} \xrightarrow{d_p} \emptyset$$

The LNA gives the familiar result that protein noise scales as $1/\langle n \rangle$ for large mean protein numbers $\langle n \rangle$.

### Population Dynamics

In ecological models, the system size expansion quantifies demographic stochasticity. For a predator-prey system like the Lotka-Volterra model:

$$X \xrightarrow{b_X} 2X, \quad Y + X \xrightarrow{p} 2Y, \quad Y \xrightarrow{d_Y} \emptyset$$

The LNA reveals how population fluctuations drive cycles and correlations between species.

## Extensions and Refinements

### Non-Gaussian Corrections

The basic system size expansion assumes Gaussian fluctuations at the LNA level. Higher-order terms capture non-Gaussian features through skewness, kurtosis, and higher cumulants.

### Time-Scale Separation

For systems with [[time-scale separation]], the system size expansion can be combined with [[adiabatic elimination]] to derive reduced models. Fast variables are eliminated by assuming they reach quasi-steady state distributions conditioned on slow variables.

### Spatial Extensions

The system size expansion has been extended to [[spatially extended systems]] by incorporating diffusion or other spatial transport mechanisms:

$$\frac{\partial P(\mathbf{n}, t)}{\partial t} = \mathcal{L}_{\text{reaction}}P + \mathcal{L}_{\text{diffusion}}P$$

This leads to [[stochastic partial differential equations]] describing spatiotemporal fluctuations.

## Mathematical Challenges and Limitations

### Convergence Properties

The system size expansion is an asymptotic series that may not converge for all systems. The validity and convergence properties depend on:
- System size $\Omega$
- Proximity to bifurcations or critical points
- Presence of multiple scales
- Nature of the nonlinearities

### Critical Phenomena

Near [[critical points]] or [[bifurcations]], the system size expansion breaks down because fluctuations become large and strongly non-Gaussian. Alternative approaches like [[renormalization group]] methods are needed.

### Multimodality

For systems with [[multimodal distributions]], the basic expansion fails because it assumes fluctuations around a single deterministic trajectory. Extensions like the [[Conditional Linear Noise Approximation]] address this by using multiple reference states.

## Historical Development

The system size expansion was first developed by Nicolaas van Kampen in the 1960s and presented comprehensively in his 1981 book "Stochastic Processes in Physics and Chemistry." Related approaches include:

- Kramers-Moyal expansion
- WKB approximation for master equations
- Î©-expansion by Kubo, Matsuo, and Kitahara

The approach has been continuously refined and extended by numerous researchers to address increasingly complex stochastic systems.

## Mathematical Notation Summary

For clarity, here is a consolidated notation summary:

- $\mathbf{n}$: Vector of molecule numbers or population counts
- $\Omega$: System size parameter
- $\boldsymbol{\phi}$: Vector of deterministic concentrations
- $\boldsymbol{\xi}$: Vector of fluctuations
- $P(\mathbf{n}, t)$: Probability distribution in terms of absolute numbers
- $\Pi(\boldsymbol{\xi}, t)$: Probability distribution in terms of fluctuations
- $a_j(\mathbf{n})$: Propensity function for reaction $j$
- $f_j(\boldsymbol{\phi})$: Macroscopic rate function
- $\mathbf{S}$: Stoichiometric matrix
- $J$: Jacobian matrix
- $D$: Diffusion matrix
- $C$: Covariance matrix of fluctuations

## Conclusion

The system size expansion provides a rigorous framework for deriving approximations to master equations that describe stochastic processes. By systematically expanding in powers of the inverse system size, it connects microscopic stochasticity to macroscopic determinism, revealing how the latter emerges as an asymptotic limit. The approach has found widespread applications across physics, chemistry, and biology, offering insights into how stochasticity manifests at different scales and how intrinsic noise affects system behavior.


---

preceding: [[linear noise approximation (lna) for biochemical reaction networks]]

See also: [[partial differential equations]]