---
date: 1726288742.295061
tags:
- autogenerated
- source__oai
- conversation_id__66e51365-be40-8008-8c83-8b6cecc9068b
- msg_aaa20e21-46ae-4cb7-be7b-ab73331605dd
- msg_3759690b-e400-47dc-b3ae-375cd3f3510b
- colorclass/information-theory
title: feynman-kac formula
---

**USER**

Feynman-Kac Formula


**ASSISTANT**

The **Feynman-Kac formula** is a powerful result that provides a deep connection between **partial differential equations (PDEs)** and **stochastic processes**. Specifically, it connects certain second-order parabolic PDEs to expectations of functionals of stochastic processes, typically related to **Brownian motion**. The formula is highly useful in areas such as mathematical finance, physics, and probability theory.

### The Core Idea

The Feynman-Kac formula transforms a **linear parabolic PDE** into an **expectation** of a functional of a stochastic process, usually a diffusion process governed by a **stochastic differential equation (SDE)**. This gives a probabilistic solution to the PDE, using the machinery of stochastic calculus.

#### PDE Setup

Consider the following general form of a parabolic PDE:

$$
\frac{\partial u(t, x)}{\partial t} + \mathcal{L} u(t, x) = f(t, x, u(t, x)), \quad u(T, x) = g(x),
$$

where $u(t, x)$ is the unknown function, and $\mathcal{L}$ is a second-order differential operator of the form:

$$
\mathcal{L} u(t, x) = \frac{1}{2} \sigma^2(x) \frac{\partial^2 u(t, x)}{\partial x^2} + \mu(x) \frac{\partial u(t, x)}{\partial x}.
$$

Here:
- $\sigma(x)$ represents the volatility (or diffusion coefficient),
- $\mu(x)$ represents the drift,
- $f(t, x, u)$ is a source term, and
- $g(x)$ is the terminal condition at $t = T$.

#### Corresponding Stochastic Process

The Feynman-Kac theorem tells us that the solution to the PDE can be represented in terms of the expectation of a functional of a **stochastic process**. Specifically, let $X_t$ be a **stochastic process** described by the following SDE:

$$
dX_t = \mu(X_t) \, dt + \sigma(X_t) \, dW_t,
$$

where $W_t$ is a standard **Brownian motion** and $\mu(X_t), \sigma(X_t)$ are the drift and diffusion coefficients, respectively.

### Feynman-Kac Formula

Given the setup of the parabolic PDE, the Feynman-Kac formula provides the solution $u(t, x)$ as:

$$
u(t, x) = \mathbb{E}^{\mathbb{P}} \left[ \left. g(X_T) \, e^{\int_t^T f(s, X_s, u(s, X_s)) \, ds} \right| X_t = x \right],
$$

where:
- $\mathbb{E}^{\mathbb{P}}[\cdot]$ denotes the expectation with respect to the probability measure $\mathbb{P}$ (typically under which $W_t$ is a standard Brownian motion),
- $g(X_T)$ is the terminal condition of the PDE, and
- the exponential factor $e^{\int_t^T f(s, X_s, u(s, X_s)) \, ds}$ comes from the source term $f(t, x, u)$.

### Special Case (Without Source Term)

In the simpler case where $f(t, x, u) = 0$ (i.e., no source term in the PDE), the formula simplifies to:

$$
u(t, x) = \mathbb{E}^{\mathbb{P}} \left[ g(X_T) \mid X_t = x \right].
$$

Thus, the solution to the PDE is given by the expected value of the terminal condition $g(X_T)$, where $X_T$ is the solution to the SDE starting from $X_t = x$.

### Financial Example: Black-Scholes Equation

In **mathematical finance**, the Feynman-Kac formula provides a probabilistic representation of the solution to the **Black-Scholes PDE**, which is used to price options. In this context, the PDE for the price of an option $V(t, S)$ (as a function of time $t$ and underlying asset price $S$) is:

$$
\frac{\partial V}{\partial t} + r S \frac{\partial V}{\partial S} + \frac{1}{2} \sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} - r V = 0,
$$

with boundary condition $V(T, S) = h(S)$, where $h(S)$ is the payoff of the option at maturity.

Using the Feynman-Kac formula, the solution to this PDE can be expressed as:

$$
V(t, S) = \mathbb{E}^{\mathbb{P}} \left[ e^{-r(T-t)} h(S_T) \mid S_t = S \right],
$$

where $S_T$ follows the geometric Brownian motion:

$$
dS_t = r S_t \, dt + \sigma S_t \, dW_t,
$$

with $r$ being the risk-free rate, and $\sigma$ the volatility.

### Interpretation

The Feynman-Kac formula is powerful because it allows us to solve PDEs using stochastic process theory, bypassing the need for direct analytic or numerical methods for PDEs. The solution is interpreted as the expected value of a functional of a stochastic process, which can often be estimated using **Monte Carlo methods** or other probabilistic tools.

### Summary of Key Components

- **PDE of Interest**: Second-order parabolic PDE with terminal condition.
- **Stochastic Process**: Typically driven by an SDE with drift $\mu(x)$ and volatility $\sigma(x)$.
- **Expectation Representation**: The solution to the PDE is given by the expected value of a functional of the stochastic process, incorporating the terminal condition $g(x)$ and possibly a source term $f(t, x, u)$.

In applications like **quantitative finance** and **statistical physics**, the Feynman-Kac formula provides a bridge between deterministic PDEs and probabilistic models, particularly when modeling systems influenced by randomness (e.g., pricing derivatives under stochastic market conditions or diffusion in random media).---
date: 1721882032.267136
tags:
- autogenerated
- source__oai
- conversation_id__91d0b461-37b0-4e34-904d-d5ee935d61bb
- msg_aaa266e7-587d-47fc-b9b3-fbf42cdac704
- msg_e32f6383-d151-4cd4-b01b-3b7b00731634
title: feynman-kac formula
---


**USER**

Feynman-Kac Formula


**ASSISTANT**

### Feynman-Kac Formula

The **Feynman-Kac Formula** is a significant result in the theory of stochastic processes, linking partial differential equations (PDEs) with expectations of stochastic processes. It provides a method for solving certain types of PDEs using the expected values of functionals of stochastic processes. This connection is particularly useful in mathematical finance for pricing derivatives.

### Statement of the Feynman-Kac Formula

Consider the second-order linear PDE:

$$
\frac{\partial u}{\partial t} + \mu(x,t) \frac{\partial u}{\partial x} + \frac{1}{2} \sigma^2(x,t) \frac{\partial^2 u}{\partial x^2} - r(x,t) u + f(x,t) = 0,
$$

with the terminal condition \( u(x, T) = g(x) \).

The Feynman-Kac formula states that the solution \( u(x, t) \) can be represented as:

$$
u(x,t) = E^{x,t} \left[ e^{-\int_t^T r(X_s, s) \, ds} g(X_T) + \int_t^T e^{-\int_t^s r(X_u, u) \, du} f(X_s, s) \, ds \right],
$$

where \( X_s \) is the stochastic process governed by the stochastic differential equation (SDE):

$$
dX_s = \mu(X_s, s) \, ds + \sigma(X_s, s) \, dW_s,
$$

with initial condition \( X_t = x \).

### Intuition and Interpretation

The Feynman-Kac formula transforms a PDE into a problem involving expectations of stochastic processes. It connects the solution of a PDE to the expected value of a functional of a stochastic process, allowing us to solve the PDE using probabilistic methods.

### Applications in Finance

The Feynman-Kac formula is widely used in financial mathematics, particularly for pricing derivatives. One of the most common applications is in the derivation of the Black-Scholes formula for pricing European options.

### Example: Black-Scholes Equation

#### Black-Scholes PDE

The Black-Scholes PDE for a European call option \( C(S, t) \) is given by:

$$
\frac{\partial C}{\partial t} + \frac{1}{2} \sigma^2 S^2 \frac{\partial^2 C}{\partial S^2} + r S \frac{\partial C}{\partial S} - r C = 0,
$$

with the terminal condition \( C(S, T) = \max(S - K, 0) \).

#### Application of the Feynman-Kac Formula

1. **Define the Stochastic Process**: Let \( S_t \) follow the geometric Brownian motion:
   \[
   dS_t = \mu S_t \, dt + \sigma S_t \, dW_t.
   \]

   Under the risk-neutral measure \( Q \), the drift term \( \mu \) is replaced by the risk-free rate \( r \):
   \[
   dS_t = r S_t \, dt + \sigma S_t \, dW_t^Q.
   \]

2. **Terminal Condition and Payoff**: The terminal payoff for the European call option is \( g(S_T) = \max(S_T - K, 0) \).

3. **Solution Using the Feynman-Kac Formula**: According to the Feynman-Kac formula, the solution to the Black-Scholes PDE is:
   \[
   C(S, t) = E^Q \left[ e^{-r(T-t)} g(S_T) \mid S_t = S \right].
   \]

   Substituting the terminal payoff:
   \[
   C(S, t) = E^Q \left[ e^{-r(T-t)} \max(S_T - K, 0) \mid S_t = S \right].
   \]

This expectation can be computed using the properties of the log-normal distribution of \( S_T \), leading to the closed-form Black-Scholes formula.

### Derivation

To derive the Feynman-Kac formula, consider the following steps:

1. **Stochastic Process**: Let \( X_t \) be governed by the SDE:
   \[
   dX_t = \mu(X_t, t) \, dt + \sigma(X_t, t) \, dW_t,
   \]
   with \( X_t = x \).

2. **Function \( u(X_t, t) \)**: Suppose \( u(X_t, t) \) is a solution to the PDE:
   \[
   \frac{\partial u}{\partial t} + \mu(x,t) \frac{\partial u}{\partial x} + \frac{1}{2} \sigma^2(x,t) \frac{\partial^2 u}{\partial x^2} - r(x,t) u + f(x,t) = 0,
   \]
   with the terminal condition \( u(X_T, T) = g(X_T) \).

3. **Ito's Lemma**: Apply Ito's Lemma to \( u(X_t, t) \):
   \[
   du = \left( \frac{\partial u}{\partial t} + \mu(X_t, t) \frac{\partial u}{\partial X} + \frac{1}{2} \sigma^2(X_t, t) \frac{\partial^2 u}{\partial X^2} \right) dt + \sigma(X_t, t) \frac{\partial u}{\partial X} dW_t.
   \]

4. **Substitute the PDE**: Substitute the PDE into the Ito's Lemma result:
   \[
   du = \left( r(X_t, t) u - f(X_t, t) \right) dt + \sigma(X_t, t) \frac{\partial u}{\partial X} dW_t.
   \]

5. **Integrate**: Integrate from \( t \) to \( T \):
   \[
   u(X_T, T) = u(X_t, t) + \int_t^T \left( r(X_s, s) u(X_s, s) - f(X_s, s) \right) ds + \int_t^T \sigma(X_s, s) \frac{\partial u}{\partial X}(X_s, s) dW_s.
   \]

6. **Take Expectations**: Taking the expectation under the risk-neutral measure \( Q \) and using the fact that the stochastic integral term has zero expectation, we get:
   \[
   E^Q \left[ u(X_T, T) \mid X_t = x \right] = u(x, t) + E^Q \left[ \int_t^T \left( r(X_s, s) u(X_s, s) - f(X_s, s) \right) ds \mid X_t = x \right].
   \]

7. **Final Solution**: Solve for \( u(x, t) \):
   \[
   u(x,t) = E^{x,t} \left[ e^{-\int_t^T r(X_s, s) \, ds} g(X_T) + \int_t^T e^{-\int_t^s r(X_u, u) \, du} f(X_s, s) \, ds \right].
   \]

### Conclusion

The Feynman-Kac formula is a powerful tool that connects solutions of certain PDEs to expectations of stochastic processes. It is extensively used in financial mathematics for pricing derivatives and solving various problems involving stochastic processes. By transforming PDEs into expectations, the Feynman-Kac formula facilitates the application of probabilistic methods to solve complex differential equations.


---

preceding: [[girsanov's theorem]]  


following: [[doob's martingale inequalities]]

See also: [[probability measure]]


See also: [[statistical physics]]


See also: [[probability theory]]


See also: [[stochastic processes]]


See also: [[sanov's theorem]]


See also: [[partial differential equations]]