---
date: 1717291992.648221
tags:
- autogenerated
- source__oai
- conversation_id__ca65c423-5293-48ca-a72e-29630dbc5375
- msg_aaa284f1-b534-4872-b2dc-21058511aa72
- msg_4ed5e969-c351-46db-b7e4-e15b64a011f6
- colorclass/decision-making-processes
title: compatibility distance in neat
---

**USER**

Compatibility Distance


**ASSISTANT**

## Compatibility Distance in NEAT

### Overview

In the Neuroevolution of Augmenting Topologies (NEAT) algorithm, compatibility distance is a measure used to determine how similar or different two neural network genotypes are. This metric is crucial for speciation, as it allows NEAT to group similar individuals into species, thus preserving diversity and protecting innovative structures during the evolutionary process.

### Compatibility Distance Formula

The compatibility distance \( \delta \) between two genomes \( g_1 \) and \( g_2 \) is calculated using the following formula:

$$
\delta = \frac{c_1 E}{N} + \frac{c_2 D}{N} + c_3 \bar{W}
$$

where:
- \( E \) is the number of excess genes.
- \( D \) is the number of disjoint genes.
- \( \bar{W} \) is the average weight difference of matching genes.
- \( N \) is the number of genes in the larger genome (can be set to 1 if \( N < 20 \) to avoid division by a small number).
- \( c_1, c_2, c_3 \) are coefficients that weight the importance of excess genes, disjoint genes, and weight differences, respectively.

### Gene Classification

1. **Excess Genes**: Genes that are present in one genome but not in the other, and their innovation numbers are higher than those in the other genome.
2. **Disjoint Genes**: Genes that are present in one genome but not in the other, and their innovation numbers lie between the lowest and highest innovation numbers of the other genome.
3. **Matching Genes**: Genes that have the same innovation numbers in both genomes.

### Detailed Calculation Steps

1. **Identify Matching Genes**: Compare the innovation numbers of the genes in both genomes to find matching genes.
2. **Count Excess and Disjoint Genes**: Determine the number of excess and disjoint genes based on the innovation numbers.
3. **Compute Weight Differences**: Calculate the average weight difference of the matching genes.
4. **Apply the Compatibility Formula**: Use the compatibility distance formula to compute the distance.

### Example Calculation

Consider two genomes \( g_1 \) and \( g_2 \):

**Genome \( g_1 \)**:
- Nodes: [1 (input), 2 (output), 3 (hidden)]
- Connections: [(1 → 2, w1), (1 → 3, w2), (3 → 2, w3)]

**Genome \( g_2 \)**:
- Nodes: [1 (input), 2 (output), 3 (hidden), 4 (hidden)]
- Connections: [(1 → 2, w4), (1 → 3, w5), (3 → 2, w6), (2 → 4, w7)]

#### Step 1: Identify Matching Genes
- Matching Genes: (1 → 2), (1 → 3), (3 → 2)

#### Step 2: Count Excess and Disjoint Genes
- Disjoint Genes: None, as all non-matching genes are either matching or excess.
- Excess Genes: (2 → 4) in \( g_2 \).

#### Step 3: Compute Weight Differences
- Average Weight Difference of Matching Genes: 

$$
\bar{W} = \frac{|w1 - w4| + |w2 - w5| + |w3 - w6|}{3}
$$

#### Step 4: Apply the Compatibility Formula
- Assuming \( N \) is the number of genes in \( g_2 \) (larger genome), \( N = 4 \).
- Let \( c_1, c_2, c_3 \) be given coefficients (e.g., \( c_1 = 1.0, c_2 = 1.0, c_3 = 0.4 \)).

$$
\delta = \frac{c_1 E}{N} + \frac{c_2 D}{N} + c_3 \bar{W}
$$

Substitute values:

$$
\delta = \frac{1.0 \cdot 1}{4} + \frac{1.0 \cdot 0}{4} + 0.4 \cdot \bar{W}
$$

$$
\delta = 0.25 + 0 + 0.4 \cdot \bar{W}
$$

### Speciation

NEAT uses the compatibility distance \( \delta \) to group individuals into species. An individual is assigned to a species if its compatibility distance to the species’ representative (usually the first individual in the species) is below a threshold \( \delta_t \). This threshold \( \delta_t \) is dynamically adjusted to maintain a stable number of species over generations.

### Practical Considerations

1. **Coefficient Tuning**: The coefficients \( c_1, c_2, \) and \( c_3 \) must be carefully tuned to balance the importance of excess genes, disjoint genes, and weight differences.
2. **Threshold Adjustment**: The speciation threshold \( \delta_t \) should be adjusted dynamically to ensure that the population maintains a suitable number of species.
3. **Computational Efficiency**: Calculating the compatibility distance can be computationally expensive, especially for large populations. Efficient data structures and parallel processing can help mitigate this.

### Conclusion

Compatibility distance is a fundamental component of NEAT, enabling the algorithm to maintain diversity and protect new structural innovations through speciation. By carefully measuring the genetic differences between individuals, NEAT can effectively group similar individuals and guide the evolutionary process toward discovering increasingly complex and effective neural network architectures.

For further exploration, you might delve into related topics such as [[Genotype Representation in NEAT]], [[Mutation Operations in NEAT]], and [[Speciation and Fitness Sharing in NEAT]].


---

preceding: [[[[neuroevolution]] of augmenting topologies (neat)]]  


following: [[complexification in neat]]